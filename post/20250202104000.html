<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>有道翻译js漏洞 | 希望来有所获</title><meta name="author" content="田稼禾"><meta name="copyright" content="田稼禾"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="在有道的单词翻译界面，输入一个单词进行请求，然后观察网络发包，通过检查发现webtranslate是请求的具体实现，但是前端js代码被混淆，现在开始突破： 开始大体了解一个csdn的讲解来更好学习cURL所以 过滤器用的选Fetch&#x2F;XHR 然后看的是载荷与启动器 然后观察到参数i是传递的单词复制该请求的cURL(bash) （cmd的无法识别）到该网址(https:&#x2F;&#x2F;curlconv">
<meta property="og:type" content="article">
<meta property="og:title" content="有道翻译js漏洞">
<meta property="og:url" content="https://tttjhgan.github.io/post/20250202104000.html">
<meta property="og:site_name" content="希望来有所获">
<meta property="og:description" content="在有道的单词翻译界面，输入一个单词进行请求，然后观察网络发包，通过检查发现webtranslate是请求的具体实现，但是前端js代码被混淆，现在开始突破： 开始大体了解一个csdn的讲解来更好学习cURL所以 过滤器用的选Fetch&#x2F;XHR 然后看的是载荷与启动器 然后观察到参数i是传递的单词复制该请求的cURL(bash) （cmd的无法识别）到该网址(https:&#x2F;&#x2F;curlconv">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tttjhgan.github.io/img/touxiang.png">
<meta property="article:published_time" content="2025-02-02T02:40:00.000Z">
<meta property="article:modified_time" content="2025-02-02T02:42:00.000Z">
<meta property="article:author" content="田稼禾">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tttjhgan.github.io/img/touxiang.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "有道翻译js漏洞",
  "url": "https://tttjhgan.github.io/post/20250202104000.html",
  "image": "https://tttjhgan.github.io/img/touxiang.png",
  "datePublished": "2025-02-02T02:40:00.000Z",
  "dateModified": "2025-02-02T02:42:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "田稼禾",
      "url": "https://tttjhgan.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/tubiao.png"><link rel="canonical" href="https://tttjhgan.github.io/post/20250202104000.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '有道翻译js漏洞',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/beijing.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">希望来有所获</span></a><a class="nav-page-title" href="/"><span class="site-name">有道翻译js漏洞</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">有道翻译js漏洞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-02T02:40:00.000Z" title="发表于 2025-02-02 10:40:00">2025-02-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-02T02:42:00.000Z" title="更新于 2025-02-02 10:42:00">2025-02-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>在有道的单词翻译界面，输入一个单词进行请求，然后观察网络发包，通过检查发现webtranslate是请求的具体实现，但是前端js代码被混淆，现在开始突破：</p>
<h2 id="开始大体了解"><a href="#开始大体了解" class="headerlink" title="开始大体了解"></a>开始大体了解</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ningmengban/article/details/118738013">一个csdn的讲解来更好学习cURL</a><br>所以 过滤器用的选Fetch&#x2F;XHR 然后看的是<font color="#ff0000">载荷与启动器</font><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0NWt"><img src="https://s21.ax1x.com/2024/11/23/pAf0NWt.png" alt="pAf0NWt.png"></a></p>
<p>然后观察到参数<code>i</code>是传递的单词<br>复制该请求的cURL(bash) （cmd的无法识别）到该网址(<a target="_blank" rel="noopener" href="https://curlconverter.com/">https://curlconverter.com/</a>)中转成pythond代码的网络请求。<br><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">补充CURL</a><br>	<a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0aSP"><img src="https://s21.ax1x.com/2024/11/23/pAf0aSP.png" alt="pAf0aSP.png"></a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;OUTFOX_SEARCH_USER_ID&#x27;</span>: <span class="string">&#x27;-807195057@112.6.224.59&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;OUTFOX_SEARCH_USER_ID_NCOO&#x27;</span>: <span class="string">&#x27;1295680981.8456256&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;UM_distinctid&#x27;</span>: <span class="string">&#x27;1934efa317d26a0-0cf60c63ba6004-26011851-384000-1934efa317e30e9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;DICT_DOCTRANS_SESSION_ID&#x27;</span>: <span class="string">&#x27;Nzc1YzdjMTctY2UwYi00MWRkLTljNWMtYmU0ZDZkYmE2YjFl&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;_uetsid&#x27;</span>: <span class="string">&#x27;1a0d8b00a87b11efb41e654a51bcff2d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;_uetvid&#x27;</span>: <span class="string">&#x27;1a0dc100a87b11efbea5976598c3a68c&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;_uetmsclkid&#x27;</span>: <span class="string">&#x27;_uet3e4b623b79541aa791a405049652812f&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;Cookie&#x27;: &#x27;OUTFOX_SEARCH_USER_ID=-807195057@112.6.224.59; OUTFOX_SEARCH_USER_ID_NCOO=1295680981.8456256; UM_distinctid=1934efa317d26a0-0cf60c63ba6004-26011851-384000-1934efa317e30e9; DICT_DOCTRANS_SESSION_ID=Nzc1YzdjMTctY2UwYi00MWRkLTljNWMtYmU0ZDZkYmE2YjFl; _uetsid=1a0d8b00a87b11efb41e654a51bcff2d; _uetvid=1a0dc100a87b11efbea5976598c3a68c; _uetmsclkid=_uet3e4b623b79541aa791a405049652812f&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;https://fanyi.youdao.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://fanyi.youdao.com/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-site&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Google Chrome&quot;;v=&quot;131&quot;, &quot;Chromium&quot;;v=&quot;131&quot;, &quot;Not_A Brand&quot;;v=&quot;24&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;i&#x27;</span>: <span class="string">&#x27;banana&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;to&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;useTerm&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dictResult&#x27;</span>: <span class="string">&#x27;true&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;keyid&#x27;</span>: <span class="string">&#x27;webfanyi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sign&#x27;</span>: <span class="string">&#x27;341027bbf5e4757757192d5cf94ffc62&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;client&#x27;</span>: <span class="string">&#x27;fanyideskweb&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;product&#x27;</span>: <span class="string">&#x27;webfanyi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;appVersion&#x27;</span>: <span class="string">&#x27;1.0.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;vendor&#x27;</span>: <span class="string">&#x27;web&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pointParam&#x27;</span>: <span class="string">&#x27;client,mysticTime,product&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mysticTime&#x27;</span>: <span class="string">&#x27;1732276669901&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;keyfrom&#x27;</span>: <span class="string">&#x27;fanyi.web&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mid&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;screen&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;model&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;network&#x27;</span>: <span class="string">&#x27;wifi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;abtest&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yduuid&#x27;</span>: <span class="string">&#x27;abcdefg&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(<span class="string">&#x27;https://dict.youdao.com/webtranslate&#x27;</span>, cookies=cookies, headers=headers, data=data)</span><br><span class="line"><span class="comment">#加一句</span></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<p>对这个代码进行运行<br>1.修改i的值去看能不能翻译 发现不可以<br>2.同时响应内容被加密不能直观读出来</p>
<h2 id="请求逆向分析"><a href="#请求逆向分析" class="headerlink" title="请求逆向分析"></a>请求逆向分析</h2><p>然后开始找一些变化的量去逆向：对比一下不同词的请求，会发现两处不一样，一个是<code>sign</code> 值，还有一个是<code>mysticTime</code> 值<br><strong>所以猜测是，本地js签名了一个sign值，远程服务器校验了这个sign，导致我们直接修改i的话是无法成功拿到数据的。</strong><br>所以我们的目标是<strong>逆向这两个变化值</strong></p>
<p>先从webtranslate这个包中的第一个调用堆栈去看<br>在send处打上断点 然后重新请求一下（指输入不同单词），发现该函数的调用堆栈<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0tJI"><img src="https://s21.ax1x.com/2024/11/23/pAf0tJI.png" alt="pAf0tJI.png"></a><br>进入xhr请求函数（随便进入一个都可以）<br>要在<strong>作用域</strong>中的 params参数中去看 发包发出去了什么变量 发现sign已经生成<a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0dQf"><img src="https://s21.ax1x.com/2024/11/23/pAf0dQf.png" alt="pAf0dQf.png"></a><br>然后去调用堆栈中一个个函数去找 观察哪一个生成了sign<br>这里的I函数没有sign，而上一个I是有sign值的，说明是在这一步去进行了sign值生成 所以重点分析这里<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf00OS"><img src="https://s21.ax1x.com/2024/11/23/pAf00OS.png" alt="pAf00OS.png"></a><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0Deg"><img src="https://s21.ax1x.com/2024/11/23/pAf0Deg.png" alt="pAf0Deg.png"></a><br>给I跟下面的匿名打上断点 去分析两者夹着的代码，因为此时sign在t变量里面 所以去看含t的就函数 发现K(t)非常可疑<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfBRNd"><img src="https://s21.ax1x.com/2024/11/23/pAfBRNd.png" alt="pAfBRNd.png"></a><br>控制台用一下<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0wy8"><img src="https://s21.ax1x.com/2024/11/23/pAf0wy8.png" alt="pAf0wy8.png"></a><br>接下来分析k(t)是如何实现的，在k(t)前面去断点调试<a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0rwQ"><img src="https://s21.ax1x.com/2024/11/23/pAf0rwQ.png" alt="pAf0rwQ.png"></a></p>
<p>这里我们很明显发现sign值就是k生成显示的，其值是由S函数生成的，往上一看就是S的调用，它又调用了一个匿名函数，是md5算法，加密的字符串就是简单的拼接这个字符串 </p>
<p><code>return _(`client=$&#123;d&#125;&amp;mysticTime=$&#123;e&#125;&amp;product=$&#123;u&#125;&amp;key=$&#123;t&#125;`)</code><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAf0YFA"><img src="https://s21.ax1x.com/2024/11/23/pAf0YFA.png" alt="pAf0YFA.png"></a></p>
<h3 id="逻辑："><a href="#逻辑：" class="headerlink" title="逻辑："></a>逻辑：</h3><p>k⽣成了Sign<br>k返回的是⼀个data字典<br>字典⾥的sign值是由S函数⽣成的<br>S函数调⽤了_匿名函数<br>且_函数调⽤md5加密了内容⽣成sign值</p>
<p>其中d就是<code>fanyideskweb</code> <code>product</code>就是<code>webfanyi</code> key是个定值，具体就是从多次分析中发现，key没有变(一直取e)<br>是这个值asdjnjfenknafdfsdfsd ，最后我们需要看一下这个mysticTime的获取，发现它就是传入的a，a是const a &#x3D; (new Date).getTime(); 是获取当前时间</p>
<p>然后简单用python代码复现一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">e</span>):</span><br><span class="line">    d=<span class="string">&#x27;fanyideskweb&#x27;</span></span><br><span class="line">    u = <span class="string">&#x27;webfanyi&#x27;</span></span><br><span class="line">    t = <span class="string">&#x27;fsdsogkndfokasodnaso&#x27;</span></span><br><span class="line">    <span class="comment"># e = str(int(time.time()*1000))</span></span><br><span class="line">    payload = <span class="string">f&quot;client=<span class="subst">&#123;d&#125;</span>&amp;mysticTime=<span class="subst">&#123;e&#125;</span>&amp;product=<span class="subst">&#123;u&#125;</span>&amp;key=<span class="subst">&#123;t&#125;</span>&quot;</span></span><br><span class="line">    m = hashlib.md5() <span class="comment"># 创建md5对象</span></span><br><span class="line">    m.update(payload.encode()) <span class="comment"># 对payload进行编码</span></span><br><span class="line">    <span class="keyword">return</span> m.hexdigest() <span class="comment"># 返回md5值</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="解释："><a href="#解释：" class="headerlink" title="解释："></a>解释：</h4><p>这段代码使用了Python的f-string（格式化字符串字面量）来构建一个查询字符串，它与JavaScript模板字符串的作用类似。f-string允许你在字符串中直接嵌入表达式，并且会自动将表达式的值替换到字符串中。这里的<code>d</code>、<code>e</code>、<code>u</code>、<code>t</code>是变量，它们将被替换为它们的值。<br>这里的e为传入的时间，自此，将sign值和mysticTime替换成我们的值，就可以正确获取响应了，但是响应是加密的，还需要解密</p>
<h2 id="响应逆向分析"><a href="#响应逆向分析" class="headerlink" title="响应逆向分析"></a>响应逆向分析</h2><p>我们刚刚通过I函数的位置找到了获取sign值的函数，那么在此附近可以看一下解密的函数，因为猜测拿到响应就解密<br>在 下面（e，t，a）打上断电后单步调试F10  同时还发现下面有个feedback（反馈）函数中也有（e，t，a） 还有 解密，接下来就去确定变量值<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfBh9I"><img src="https://s21.ax1x.com/2024/11/23/pAfBh9I.png" alt="pAfBh9I.png"></a><br>发现此处有个些带key的变量 调试显示o 为“fsdsogkndfokasodnaso”   -&gt;后面发现这个是key<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfB43t"><img src="https://s21.ax1x.com/2024/11/23/pAfB43t.png" alt="pAfB43t.png"></a><br>然后继续调试有个e字典出现 带着<code>data：&quot;Z21kD9ZK1ke6ugku2ccWu-MeDWh3z252xRTQv-wZ6jddVo3tJLe7gIXz4PyxGl73nSfLAADyElSjjvrYdCvEP4pfohVVEX1DxoI0yhm36ytQNvu-WLU94qULZQ72aml6JKK7ArS9fJXAcsG7ufBIE0gd6fbnhFcsGmdXspZe-8whVFbRB_8Fc9JlMHh8DDXnskDhGfEscN_rfi-A-AHB3F9Vets82vIYpkGNaJOft_JA-m5cGEjo-UNRDDpkTz_NIAvo5PbATpkh7PSna2tHcE6Hou9GBtPLB67vjScwplB96-zqZKXJJEzU5HGF0oPDY_weAkXArzXyGLBPXFCnn_IWJDkGD4vqBQQAh2n52f48GD_cb-PSCT_8b-ESsKUI9NJa11XsdaUZxAc8TzrYnXwdcQbtl_kZGKhS6_rCtuNEBouA_lvM2CbS7TTtV2U4zVmJKpp-c6nt3yZePK3Av01GWn1pH_3sZbaPEx8DUjSbdp4i4iK-Mj4p2HPoph67DR7B9MFETYku_28SgP9xsKRRvFH4aHBHESWX4FDbwaU=&quot;</code><br>像是base64编码-&gt;发给ai后：您提供的字符串看起来像是一个Base64编码的字符串，但是包含了URL安全的字符（<code>-</code> 和 <code>_</code>）。在Python中，您可以使用<code>base64</code>模块来解码这样的字符串<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfB5gP"><img src="https://s21.ax1x.com/2024/11/23/pAfB5gP.png" alt="pAfB5gP.png"></a><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfBIjf"><img src="https://s21.ax1x.com/2024/11/23/pAfBIjf.png" alt="pAfBIjf.png"></a><br>之后e的传给了o<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfB7DS"><img src="https://s21.ax1x.com/2024/11/23/pAfB7DS.png" alt="pAfB7DS.png"></a></p>
<p>之后来到关键解密处 打上断点一步步调试：发现e还是data值<br>发现 <code>t=&quot;ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl&quot;</code><br><code>a = &quot;ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4&quot;</code><br>两个变量 是个不变的定值 然后用T()函数进行加工后赋值给o和n<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAfBHHg"><img src="https://s21.ax1x.com/2024/11/23/pAfBHHg.png" alt="pAfBHHg.png"></a><br>T（）函数在生成sign时候见过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function T(e) &#123;</span><br><span class="line">    return i.createHash(&quot;md5&quot;).update(e).digest()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="贴一个ai解释："><a href="#贴一个ai解释：" class="headerlink" title="贴一个ai解释："></a>贴一个ai解释：</h4><p>您提供的代码片段看起来像是JavaScript中用于生成MD5哈希值的代码。这段代码使用了Node.js的<code>crypto</code>模块来创建一个MD5哈希。下面是这段代码的解释：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建一个MD5哈希实例</span></span><br><span class="line"><span class="keyword">const</span> hash = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line"><span class="comment">// 更新哈希实例，添加需要哈希的数据</span></span><br><span class="line">hash.<span class="title function_">update</span>(e);</span><br><span class="line"><span class="comment">// 完成哈希计算并返回结果</span></span><br><span class="line"><span class="keyword">const</span> result = hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>这里的<code>e</code>应该是一个字符串或者是一个Buffer对象，代表你想要生成MD5哈希的数据。<code>update</code>方法用于添加数据到哈希对象中，而<code>digest</code>方法则用于计算最终的哈希值。<code>digest</code>方法的参数<code>&#39;hex&#39;</code>表示返回的哈希值应该是十六进制字符串格式。</p>
<h4 id="所以对加密的总结是："><a href="#所以对加密的总结是：" class="headerlink" title="所以对加密的总结是："></a>所以对加密的总结是：</h4><p>加密模式是AES-CBC 。 o，n 为一个密钥一个初始化向量，响应文本给的是密文<br>以十六进制去运算的 输出是utf-8</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decodeResponse</span>(<span class="params">response</span>):</span><br><span class="line">        <span class="comment">#响应文本为base64编码过的</span></span><br><span class="line">        base64_encode_data = response.text.replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="comment"># 将URL安全的Base64字符转换为标准Base64字符</span></span><br><span class="line">        base64_decode_data = base64.b64decode(base64_encode_data)</span><br><span class="line">        <span class="comment">#print(base64_decode_data)</span></span><br><span class="line">        t=<span class="string">&#x27;ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl&#x27;</span></span><br><span class="line">        a=<span class="string">&#x27;ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4&#x27;</span></span><br><span class="line">        <span class="comment">#这样三步后返回十六进制哈希值</span></span><br><span class="line">        </span><br><span class="line">        m = hashlib.md5()</span><br><span class="line">        m.update(t.encode()) </span><br><span class="line">        n=hashlib.md5()</span><br><span class="line">        n.update(a.encode()) </span><br><span class="line">		key = m.digest() <span class="comment">#网页中的o </span></span><br><span class="line">		iv = n.digest() <span class="comment">#网页中的n</span></span><br><span class="line">        <span class="comment">#创建AES对象 使用CBC模式</span></span><br><span class="line">        aes = AES.new(key, AES.MODE_CBC, iv) </span><br><span class="line">        data = aes.decrypt(base64_decode_data) <span class="comment">#解密</span></span><br><span class="line">        data= unpad(data,<span class="number">16</span>) <span class="comment">#去除PKCS7填充，确保数据长度是16的倍数</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#将解密后的字节数据解码为UTF-8格式的字符串</span></span><br><span class="line">        <span class="comment">#将字符串解析为JSON对象</span></span><br><span class="line">        res=json.loads(data.decode()) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;中文结果:&#x27;</span>,res[<span class="string">&#x27;translateResult&#x27;</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="string">&#x27;tgt&#x27;</span>])</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;翻译未成功&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="自身不懂的点的解释"><a href="#自身不懂的点的解释" class="headerlink" title="自身不懂的点的解释"></a>自身不懂的点的解释</h4><ol>
<li><code>unpad</code>函数是用于去除PKCS7填充的函数。在加密数据时，为了满足某些加密算法对数据长度的要求（比如AES要求数据长度必须是块大小的整数倍），通常会添加一些填充字节。PKCS7是一种常用的填充方案，它规定填充的字节的值等于填充的长度。<br><code>unpad</code>函数的作用就是从解密后的数据中去除这些填充字节，恢复原始数据。在Python的<code>Crypto.Util.Padding</code>模块中提供了<code>unpad</code>函数，可以很方便地去除PKCS7填充</li>
<li>res[‘translateResult’] 是最外层的列表<br> [0] 获取第一组翻译结果<br> [0] 获取第一条翻译<br> [‘tgt’] 获取目标语言(target)的翻译文本</li>
</ol>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">e</span>):</span><br><span class="line">    d=<span class="string">&#x27;fanyideskweb&#x27;</span></span><br><span class="line">    u = <span class="string">&#x27;webfanyi&#x27;</span></span><br><span class="line">    t = <span class="string">&#x27;fsdsogkndfokasodnaso&#x27;</span></span><br><span class="line">    <span class="comment"># e = str(int(time.time()*1000))</span></span><br><span class="line">    payload = <span class="string">f&quot;client=<span class="subst">&#123;d&#125;</span>&amp;mysticTime=<span class="subst">&#123;e&#125;</span>&amp;product=<span class="subst">&#123;u&#125;</span>&amp;key=<span class="subst">&#123;t&#125;</span>&quot;</span></span><br><span class="line">    m = hashlib.md5() <span class="comment"># 创建md5对象</span></span><br><span class="line">    m.update(payload.encode()) <span class="comment"># 对payload进行编码</span></span><br><span class="line">    <span class="keyword">return</span> m.hexdigest() <span class="comment"># 返回md5值</span></span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;OUTFOX_SEARCH_USER_ID&#x27;</span>: <span class="string">&#x27;1760702234@221.2.164.11&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;OUTFOX_SEARCH_USER_ID_NCOO&#x27;</span>: <span class="string">&#x27;1426232579.0837824&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;DICT_DOCTRANS_SESSION_ID&#x27;</span>: <span class="string">&#x27;MzQ3NDhmNmMtZGEyYy00OWRjLWJjOTMtZWU2ODFmMmExYzk2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;_uetsid&#x27;</span>: <span class="string">&#x27;161449f0a69a11ef93f8d9d82f396997&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;_uetvid&#x27;</span>: <span class="string">&#x27;16144de0a69a11ef9082e976e1786dda&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;Cookie&#x27;: &#x27;OUTFOX_SEARCH_USER_ID=1760702234@221.2.164.11; OUTFOX_SEARCH_USER_ID_NCOO=1426232579.0837824; DICT_DOCTRANS_SESSION_ID=MzQ3NDhmNmMtZGEyYy00OWRjLWJjOTMtZWU2ODFmMmExYzk2; _uetsid=161449f0a69a11ef93f8d9d82f396997; _uetvid=16144de0a69a11ef9082e976e1786dda&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;https://fanyi.youdao.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://fanyi.youdao.com/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-site&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Google Chrome&quot;;v=&quot;131&quot;, &quot;Chromium&quot;;v=&quot;131&quot;, &quot;Not_A Brand&quot;;v=&quot;24&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;macOS&quot;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line">t = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time()*<span class="number">1000</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decodeResponse</span>(<span class="params">response</span>):</span><br><span class="line">        <span class="comment">#响应文本为base64编码过的</span></span><br><span class="line">        base64_encode_data = response.text.replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="comment"># 将URL安全的Base64字符转换为标准Base64字符</span></span><br><span class="line">        base64_decode_data = base64.b64decode(base64_encode_data)</span><br><span class="line">        <span class="comment">#print(base64_decode_data)</span></span><br><span class="line">        t=<span class="string">&#x27;ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl&#x27;</span></span><br><span class="line">        a=<span class="string">&#x27;ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4&#x27;</span></span><br><span class="line">        <span class="comment">#这样三步后返回十六进制哈希值</span></span><br><span class="line">        </span><br><span class="line">        m = hashlib.md5()</span><br><span class="line">        m.update(t.encode()) </span><br><span class="line">        n=hashlib.md5()</span><br><span class="line">        n.update(a.encode()) </span><br><span class="line">        key = m.digest() <span class="comment">#网页中的o </span></span><br><span class="line">        iv = n.digest() <span class="comment">#网页中的n</span></span><br><span class="line">        <span class="comment">#创建AES对象 使用CBC模式</span></span><br><span class="line">        aes = AES.new(key, AES.MODE_CBC, iv) </span><br><span class="line">        data = aes.decrypt(base64_decode_data) <span class="comment">#解密</span></span><br><span class="line">        data= unpad(data,<span class="number">16</span>) <span class="comment">#去除PKCS7填充，确保数据长度是16的倍数</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#将解密后的字节数据解码为UTF-8格式的字符串</span></span><br><span class="line">        <span class="comment">#将字符串解析为JSON对象</span></span><br><span class="line">        res=json.loads(data.decode()) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;中文结果:&#x27;</span>,res[<span class="string">&#x27;translateResult&#x27;</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="string">&#x27;tgt&#x27;</span>])</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;翻译未成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    word = <span class="built_in">input</span>(<span class="string">&#x27;请输入要翻译的词：&#x27;</span>)</span><br><span class="line">    data = &#123;</span><br><span class="line">    <span class="string">&#x27;i&#x27;</span>: word,</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;to&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;useTerm&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dictResult&#x27;</span>: <span class="string">&#x27;true&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;keyid&#x27;</span>: <span class="string">&#x27;webfanyi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sign&#x27;</span>: getSign(t),</span><br><span class="line">    <span class="string">&#x27;client&#x27;</span>: <span class="string">&#x27;fanyideskweb&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;product&#x27;</span>: <span class="string">&#x27;webfanyi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;appVersion&#x27;</span>: <span class="string">&#x27;1.0.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;vendor&#x27;</span>: <span class="string">&#x27;web&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pointParam&#x27;</span>: <span class="string">&#x27;client,mysticTime,product&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mysticTime&#x27;</span>: t,</span><br><span class="line">    <span class="string">&#x27;keyfrom&#x27;</span>: <span class="string">&#x27;fanyi.web&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mid&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;screen&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;model&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;network&#x27;</span>: <span class="string">&#x27;wifi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;abtest&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yduuid&#x27;</span>: <span class="string">&#x27;abcdefg&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(<span class="string">&#x27;https://dict.youdao.com/webtranslate&#x27;</span>, cookies=cookies, headers=headers, data=data)</span><br><span class="line">    <span class="comment"># print(response.text)</span></span><br><span class="line">    decodeResponse(response)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://tttjhgan.github.io">田稼禾</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://tttjhgan.github.io/post/20250202104000.html">https://tttjhgan.github.io/post/20250202104000.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://tttjhgan.github.io" target="_blank">希望来有所获</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/touxiang.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/post/20250201222237.html" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot;  More info: Writing Run server$ hexo server  More info: Server Generate static files$ hexo generate  More info: Generating Deploy to remote sites$ hexo deploy  More info: Deployment </div></div></div></a><a class="pagination-related" href="/post/20250213215859.html" title="文件上传"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">文件上传</div></div><div class="info-2"><div class="info-item-1"> PHP 应用&amp;文件上传&amp;函数缺陷&amp;条件竞争&amp;二次渲染&amp;黑白名单&amp;JS 绕过学习前必读：1、课前一定要明白：无文件解析安全问题上，格式解析是一对一的（不能 jpg 解析 php）换句话来说有解析错误配置或后缀解析漏洞时才能实现格式差异解析2、文件上传安全指的是攻击者通过利用上传实现后门的写入连接后门进行权限控制的安全问题，对于如何确保这类安全问题，一般会从原生态功能中的文件内容，文件后缀，文件类型等方面判断，但是漏洞可能不仅在本身的代码验证逻辑中出现安全问题，也会在语言版本，语言函数，中间件，引用的第三方编辑器等存在缺陷地方配合利用。另外文件上传也有多个存储逻辑，不同的文件存储方案也会给攻击者带来不一样的挑战！ 测试环境安装参考：https://github.com/ffffffff0x/f8xhttps://github.com/fuzzdb-project/fuzzdbhttps://github.com/sqlsec/upload-labs-docker 0、下载上述资源1、docker 安装f8x -d 或 f8x...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">田稼禾</div><div class="author-info-description">保持热爱与冷静</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E5%A4%A7%E4%BD%93%E4%BA%86%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">开始大体了解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">请求逆向分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">逻辑：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A%EF%BC%9A"><span class="toc-number">2.1.1.</span> <span class="toc-text">解释：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">响应逆向分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%B4%E4%B8%80%E4%B8%AAai%E8%A7%A3%E9%87%8A%EF%BC%9A"><span class="toc-number">3.0.1.</span> <span class="toc-text">贴一个ai解释：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%80%E4%BB%A5%E5%AF%B9%E5%8A%A0%E5%AF%86%E7%9A%84%E6%80%BB%E7%BB%93%E6%98%AF%EF%BC%9A"><span class="toc-number">3.0.2.</span> <span class="toc-text">所以对加密的总结是：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BA%AB%E4%B8%8D%E6%87%82%E7%9A%84%E7%82%B9%E7%9A%84%E8%A7%A3%E9%87%8A"><span class="toc-number">3.0.3.</span> <span class="toc-text">自身不懂的点的解释</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">完整代码</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/20250213215859.html" title="文件上传">文件上传</a><time datetime="2025-02-13T13:58:59.000Z" title="发表于 2025-02-13 21:58:59">2025-02-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/20250202104000.html" title="有道翻译js漏洞">有道翻译js漏洞</a><time datetime="2025-02-02T02:40:00.000Z" title="发表于 2025-02-02 10:40:00">2025-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/20250201222237.html" title="Hello World">Hello World</a><time datetime="2025-02-01T14:22:37.936Z" title="发表于 2025-02-01 22:22:37">2025-02-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By 田稼禾</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索本站内容" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>